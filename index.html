<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚ãŸã’æˆé•·è¨˜éŒ²</title>
<style>
body {
    font-family: sans-serif;
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ«å…¨ä½“ */
.modal {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚«ãƒ¼ãƒ‰ */
.modal-card {
    background: #fff;
    border-radius: 12px;
    width: 90%;
    max-width: 900px;
    max-height: 90vh;
    display: flex;
    overflow: hidden;
}

/* å†™çœŸã‚«ãƒ©ãƒ  */
.modal-left {
    flex: 1;
    background: #f8f8f8;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 300px;
}
.modal-left.hidden {
    display: none;
}
.modal-photo-placeholder {
    color: #aaa;
    font-size: 14px;
    text-align: center;
}

/* å³ã‚«ãƒ©ãƒ  */
.modal-right {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
}

/* ã‚µãƒ ãƒã‚¤ãƒ« */
.modal-thumbnails {
    display: flex;
    gap: 4px;
    overflow-x: auto;
    margin-top: 8px;
}
.modal-thumbnails img {
    width: 60px;
    height: 60px;
    object-fit: cover;
    cursor: pointer;
}

/* ã‚¹ãƒãƒ›ç”¨ */
@media (max-width: 600px) {
    .modal-card {
        flex-direction: column;
        width: 100%;
        height: 100%;
        max-width: 100%;
        border-radius: 0;
        overflow-y: auto;
    }
    .modal-left, .modal-right {
        min-width: 100%;
        max-width: 100%;
    }
    .modal-thumbnails {
        height: auto;
        flex-direction: row;
        overflow-x: auto;
        overflow-y: hidden;
    }
    .model-thumbnalis img{
        flex:  0 0 auto;
    }
}
</style>
</head>
<body>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="dayModal" class="modal">
    <div class="modal-card">
        <div id="modalLeft" class="modal-left">
            <div id="modalMainPhotoWrapper">
                <span class="modal-photo-placeholder">ğŸ“· å†™çœŸã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</span>
            </div>
            <div id="modalThumbnails" class="modal-thumbnails"></div>
        </div>
        <div class="modal-right">
            <h2 id="modalDate"></h2>
            <input type="file" id="modalPhotoInput"><br>
            <input type="text" id="modalEventInput" placeholder="ã‚¤ãƒ™ãƒ³ãƒˆå">
            <button id="modalAddEventBtn">ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ </button>
            <textarea id="modalDiary" placeholder="æ—¥è¨˜ã‚’æ›¸ãâ€¦"></textarea><br>
            <input type="number" id="modalWeight" placeholder="ä½“é‡(kg)">
            <div id="modalEntries"></div>
            <button id="modalCloseBtn">é–‰ã˜ã‚‹</button>
        </div>
    </div>
</div>

<script>
const modal = document.getElementById('dayModal');
const modalLeft = document.getElementById('modalLeft');
const modalMainPhotoWrapper = document.getElementById('modalMainPhotoWrapper');
const modalThumbnails = document.getElementById('modalThumbnails');
const modalDate = document.getElementById('modalDate');
const modalCloseBtn = document.getElementById('modalCloseBtn');

let currentDayData = {
    photos: []
};

// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
function openModal(date, data) {
    currentDayData = data || { photos: [] };
    modalDate.textContent = date;
    
    // å†™çœŸãŒãªã„å ´åˆ â†’ å·¦ã‚«ãƒ©ãƒ éè¡¨ç¤º
    if (!currentDayData.photos || currentDayData.photos.length === 0) {
        modalLeft.classList.add('hidden');
    } else {
        modalLeft.classList.remove('hidden');
        renderPhotos();
    }
    
    modal.style.display = 'flex';
}

function renderPhotos() {
    modalThumbnails.innerHTML = '';
    if (currentDayData.photos.length > 0) {
        const latest = currentDayData.photos[currentDayData.photos.length - 1];
        const latestSrc = typeof latest === 'string' ? latest : latest.src;
        modalMainPhotoWrapper.innerHTML = `<img src="${latestSrc}" style="max-width:100%;max-height:400px;">`;
        currentDayData.photos.forEach(p => {
            const src = typeof p === 'string' ? p : p.src;
            const img = document.createElement('img');
            img.src = src;
            img.onclick = () => {
                modalMainPhotoWrapper.innerHTML = `<img src="${src}" style="max-width:100%;max-height:400px;">`;
            };
            modalThumbnails.appendChild(img);
        });
    }
}

// é–‰ã˜ã‚‹
modalCloseBtn.onclick = () => {
    modal.style.display = 'none';
};

// ãƒ†ã‚¹ãƒˆèµ·å‹•
document.addEventListener('DOMContentLoaded', () => {
    openModal('2025-08-01', { photos: [] }); // ç©ºã§è¡¨ç¤º
});
</script>

</body>
</html>
